name: Node.js CI

on:
   push:
      branches: ["develop"]
   pull_request:
      branches: ["develop"]

jobs:
   build:
      runs-on: ubuntu-latest

      steps:
         - uses: actions/checkout@v2
         - name: Use Node.js 18.x
           uses: actions/setup-node@v2
           with:
              node-version: 18.x
              cache: "yarn"
         - run: yarn install

         # Thêm lệnh cài đặt các gói phụ thuộc tại đây
         - name: Install Dependencies
           run: |
             sudo apt-get update
             sudo apt-get install -y pkg-config cairo pango libpng-dev libjpeg-dev libgif-dev librsvg2-bin

         - run: yarn run build
         - name: Build & push Docker image
           uses: mr-smithers-excellent/docker-build-push@v5
           with:
               image: cuong35228102000/hust-document-system-frontend
               tags: latest
               registry: docker.io
               dockerfile: ./Dockerfile
               username: ${{ secrets.DOCKER_USERNAME}}
               password: ${{ secrets.DOCKER_PASSWORD}}
